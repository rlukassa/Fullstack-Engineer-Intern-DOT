{{#if isLoggedIn}}
<!-- ============ LOGGED-IN DASHBOARD ============ -->
<div class="page-header">
    <h1><i class="fas fa-th-large"></i> Dashboard</h1>
    <p>Selamat datang kembali, {{username}}!</p>
</div>

<!-- Stats Grid -->
<div class="grid grid-4" style="margin-bottom: 28px;">
    <div class="stat-card" style="animation-delay: 0.05s;">
        <div class="icon blue"><i class="fas fa-train"></i></div>
        <h3>{{trainsCount}}</h3>
        <p>Total Kereta</p>
    </div>
    <div class="stat-card" style="animation-delay: 0.1s;">
        <div class="icon green"><i class="fas fa-calendar-alt"></i></div>
        <h3>{{schedulesCount}}</h3>
        <p>Total Jadwal</p>
    </div>
    <div class="stat-card" style="animation-delay: 0.15s;">
        <div class="icon yellow"><i class="fas fa-map-marker-alt"></i></div>
        <h3>{{stationsCount}}</h3>
        <p>Total Stasiun</p>
    </div>
    <div class="stat-card" style="animation-delay: 0.2s;">
        <div class="icon purple"><i class="fas fa-ticket-alt"></i></div>
        <h3>{{bookingsCount}}</h3>
        <p>Total Pemesanan</p>
    </div>
</div>

<!-- Quick Actions -->
<div class="card" style="margin-bottom: 28px;">
    <div class="card-header">
        <h3 class="card-title"><i class="fas fa-bolt"></i> Aksi Cepat</h3>
    </div>
    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
        <a href="/trains" class="btn btn-primary"><i class="fas fa-train"></i> Lihat Kereta</a>
        <a href="/schedules" class="btn btn-secondary"><i class="fas fa-calendar-alt"></i> Lihat Jadwal</a>
        <a href="/stations" class="btn btn-secondary"><i class="fas fa-map-marker-alt"></i> Lihat Stasiun</a>
        <a href="/bookings" class="btn btn-secondary"><i class="fas fa-ticket-alt"></i> Pemesanan Saya</a>
    </div>
</div>

<!-- Recent Data -->
<div class="grid grid-2">
    <div class="card">
        <div class="card-header">
            <h3 class="card-title"><i class="fas fa-train"></i> Kereta Terbaru</h3>
            <a href="/trains" class="btn btn-ghost btn-sm">Lihat Semua <i class="fas fa-arrow-right"></i></a>
        </div>
        {{#if recentTrains.length}}
        <div class="table-container">
            <table class="data-table">
                <thead><tr><th>Nama</th><th>Tipe</th></tr></thead>
                <tbody>
                    {{#each recentTrains}}
                    <tr>
                        <td style="font-weight: 600;">{{this.name}}</td>
                        <td><span class="badge badge-info">{{this.type}}</span></td>
                    </tr>
                    {{/each}}
                </tbody>
            </table>
        </div>
        {{else}}
        <div class="empty-state" style="padding: 30px 20px;">
            <i class="fas fa-train"></i>
            <p>Belum ada data kereta</p>
        </div>
        {{/if}}
    </div>

    <div class="card">
        <div class="card-header">
            <h3 class="card-title"><i class="fas fa-calendar-alt"></i> Jadwal Terbaru</h3>
            <a href="/schedules" class="btn btn-ghost btn-sm">Lihat Semua <i class="fas fa-arrow-right"></i></a>
        </div>
        {{#if recentSchedules.length}}
        <div class="table-container">
            <table class="data-table">
                <thead><tr><th>Rute</th><th>Waktu</th></tr></thead>
                <tbody>
                    {{#each recentSchedules}}
                    <tr>
                        <td style="font-weight: 600;">{{this.departureStation.name}} â†’ {{this.arrivalStation.name}}</td>
                        <td>{{formatTime this.departureTime}}</td>
                    </tr>
                    {{/each}}
                </tbody>
            </table>
        </div>
        {{else}}
        <div class="empty-state" style="padding: 30px 20px;">
            <i class="fas fa-calendar-alt"></i>
            <p>Belum ada data jadwal</p>
        </div>
        {{/if}}
    </div>
</div>

{{else}}
<!-- ============ GUEST LANDING PAGE ============ -->
<style>
    .landing-wrapper { margin: -28px -32px; }

    /* --- Hero Section --- */
    .hero-section {
        display: flex;
        align-items: center;
        gap: 60px;
        padding: 60px 64px;
        background: var(--bg-surface);
        min-height: 520px;
        position: relative;
        overflow: hidden;
    }
    .hero-content { flex: 1; z-index: 2; }
    .hero-content h1 {
        font-size: 2.75rem;
        font-weight: 800;
        color: var(--text-primary);
        line-height: 1.15;
        letter-spacing: -0.03em;
        margin-bottom: 16px;
    }
    .hero-content h1 span { color: var(--primary); }
    .hero-content p {
        font-size: 1.0625rem;
        color: var(--text-muted);
        line-height: 1.7;
        margin-bottom: 32px;
        max-width: 480px;
    }
    .hero-actions { display: flex; gap: 12px; align-items: center; }
    .hero-actions .btn-hero {
        padding: 14px 32px;
        border-radius: 12px;
        font-size: 0.9375rem;
        font-weight: 600;
        font-family: inherit;
        cursor: pointer;
        transition: all 200ms ease;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        border: none;
    }
    .hero-actions .btn-hero.primary {
        background: var(--primary);
        color: #fff;
        box-shadow: 0 4px 16px rgba(59,130,246,0.3);
    }
    .hero-actions .btn-hero.primary:hover {
        background: var(--primary-hover);
        transform: translateY(-2px);
        box-shadow: 0 6px 24px rgba(59,130,246,0.35);
    }
    .hero-actions .btn-hero.secondary {
        background: var(--bg-elevated);
        color: var(--text-secondary);
        border: 1px solid var(--border);
    }
    .hero-actions .btn-hero.secondary:hover {
        background: var(--bg-hover);
        color: var(--text-primary);
        transform: translateY(-2px);
    }

    /* Hero Image Carousel */
    .hero-visual { flex: 1; z-index: 2; position: relative; }
    .carousel-container {
        position: relative;
        border-radius: 20px;
        overflow: hidden;
        box-shadow: 0 20px 60px rgba(0,0,0,0.12);
        aspect-ratio: 4/3;
    }
    .carousel-slide {
        position: absolute;
        inset: 0;
        opacity: 0;
        transition: opacity 1s ease-in-out;
    }
    .carousel-slide.active { opacity: 1; }
    .carousel-slide img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    .carousel-dots {
        position: absolute;
        bottom: 16px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 8px;
        z-index: 3;
    }
    .carousel-dot {
        width: 10px; height: 10px;
        border-radius: 50%;
        background: rgba(255,255,255,0.5);
        border: none;
        cursor: pointer;
        transition: all 200ms ease;
    }
    .carousel-dot.active {
        background: #fff;
        width: 28px;
        border-radius: 5px;
    }

    /* Subtle background decoration */
    .hero-section::before {
        content: '';
        position: absolute;
        top: -120px; right: -120px;
        width: 400px; height: 400px;
        background: radial-gradient(circle, rgba(59,130,246,0.06) 0%, transparent 70%);
        border-radius: 50%;
    }
    .hero-section::after {
        content: '';
        position: absolute;
        bottom: -80px; left: -80px;
        width: 300px; height: 300px;
        background: radial-gradient(circle, rgba(99,102,241,0.05) 0%, transparent 70%);
        border-radius: 50%;
    }

    /* --- Clients / Partners Section --- */
    .clients-section {
        padding: 40px 64px;
        text-align: center;
        background: var(--bg-base);
        border-top: 1px solid var(--border-light);
        border-bottom: 1px solid var(--border-light);
    }
    .clients-section p {
        font-size: 0.8125rem;
        color: var(--text-faint);
        margin-bottom: 24px;
        text-transform: uppercase;
        letter-spacing: 0.06em;
        font-weight: 600;
    }
    .clients-grid {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 48px;
        flex-wrap: wrap;
    }
    .client-logo {
        display: flex;
        align-items: center;
        gap: 8px;
        color: var(--text-faint);
        font-size: 1.125rem;
        font-weight: 700;
        letter-spacing: -0.01em;
        opacity: 0.5;
        transition: opacity 200ms ease;
    }
    .client-logo:hover { opacity: 0.8; }
    .client-logo i { font-size: 1.5rem; }

    /* --- Features Section --- */
    .features-section {
        padding: 80px 64px;
        text-align: center;
        background: var(--bg-surface);
    }
    .section-title {
        font-size: 1.75rem;
        font-weight: 800;
        color: var(--text-primary);
        margin-bottom: 8px;
        letter-spacing: -0.025em;
    }
    .section-subtitle {
        color: var(--text-muted);
        font-size: 0.9375rem;
        margin-bottom: 48px;
        max-width: 540px;
        margin-left: auto;
        margin-right: auto;
    }
    .features-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 32px;
        max-width: 960px;
        margin: 0 auto;
    }
    .feature-card {
        padding: 32px 24px;
        border-radius: 16px;
        background: var(--bg-elevated);
        border: 1px solid var(--border-light);
        transition: all 250ms ease;
        text-align: center;
    }
    .feature-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 30px rgba(0,0,0,0.08);
        border-color: var(--border);
    }
    .feature-icon {
        width: 56px; height: 56px;
        border-radius: 14px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 16px;
        font-size: 1.375rem;
    }
    .feature-icon.blue { background: var(--primary-light); color: var(--primary); }
    .feature-icon.green { background: var(--success-light); color: var(--success); }
    .feature-icon.violet { background: var(--violet-light); color: var(--violet); }
    .feature-card h3 {
        font-size: 1.0625rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 8px;
    }
    .feature-card p {
        color: var(--text-muted);
        font-size: 0.8125rem;
        line-height: 1.6;
    }

    /* --- Stats Section --- */
    .stats-section {
        padding: 60px 64px;
        background: linear-gradient(135deg, #3b82f6, #2563eb);
        text-align: center;
    }
    .stats-section .section-title { color: #fff; }
    .stats-section .section-subtitle { color: rgba(255,255,255,0.7); }
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 32px;
        max-width: 720px;
        margin: 0 auto;
    }
    .stat-item h3 {
        font-size: 2.25rem;
        font-weight: 800;
        color: #fff;
        letter-spacing: -0.02em;
    }
    .stat-item p {
        color: rgba(255,255,255,0.7);
        font-size: 0.875rem;
        margin-top: 4px;
    }

    /* --- CTA Section --- */
    .cta-section {
        padding: 80px 64px;
        text-align: center;
        background: var(--bg-surface);
    }
    .cta-card {
        max-width: 640px;
        margin: 0 auto;
        padding: 48px 40px;
        background: var(--bg-elevated);
        border-radius: 20px;
        border: 1px solid var(--border);
    }
    .cta-card h2 {
        font-size: 1.75rem;
        font-weight: 800;
        color: var(--text-primary);
        margin-bottom: 12px;
        letter-spacing: -0.025em;
    }
    .cta-card p {
        color: var(--text-muted);
        font-size: 0.9375rem;
        margin-bottom: 28px;
    }
    .cta-card .btn-hero.primary {
        padding: 14px 40px;
        border-radius: 12px;
        font-size: 0.9375rem;
        font-weight: 600;
        font-family: inherit;
        cursor: pointer;
        transition: all 200ms ease;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        border: none;
        background: var(--primary);
        color: #fff;
        box-shadow: 0 4px 16px rgba(59,130,246,0.3);
    }
    .cta-card .btn-hero.primary:hover {
        background: var(--primary-hover);
        transform: translateY(-2px);
    }

    /* --- Landing Footer --- */
    .landing-footer {
        padding: 24px 64px;
        border-top: 1px solid var(--border);
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: var(--bg-surface);
    }
    .landing-footer p {
        color: var(--text-faint);
        font-size: 0.75rem;
    }
    .landing-footer-links { display: flex; gap: 16px; }
    .landing-footer-links a {
        color: var(--text-muted);
        text-decoration: none;
        font-size: 0.75rem;
        transition: color 150ms ease;
    }
    .landing-footer-links a:hover { color: var(--primary); }

    @media (max-width: 1024px) {
        .hero-section { flex-direction: column; padding: 40px 32px; gap: 40px; min-height: auto; }
        .hero-content h1 { font-size: 2rem; }
        .features-grid { grid-template-columns: 1fr; max-width: 400px; }
        .stats-grid { grid-template-columns: 1fr; }
        .clients-section, .features-section, .stats-section, .cta-section { padding: 40px 32px; }
        .landing-footer { flex-direction: column; gap: 8px; text-align: center; padding: 20px 32px; }
    }
    @media (max-width: 768px) {
        .hero-section { padding: 32px 20px; }
        .hero-content h1 { font-size: 1.75rem; }
        .hero-actions { flex-direction: column; align-items: stretch; }
        .carousel-container { aspect-ratio: 16/10; }
        .clients-section, .features-section, .stats-section, .cta-section { padding: 40px 20px; }
        .landing-footer { padding: 16px 20px; }
    }
</style>

<div class="landing-wrapper">
    <!-- Hero Section -->
    <section class="hero-section">
        <div class="hero-content">
            <h1>Perjalanan Kereta <span>Tanpa Ribet</span>, Pesan Dalam Hitungan Detik</h1>
            <p>SobatKereta mempermudah pemesanan tiket kereta api dengan antarmuka modern, pembayaran instan, dan jadwal real-time dari seluruh Indonesia.</p>
            <div class="hero-actions">
                <a href="/auth/register" class="btn-hero primary">
                    <i class="fas fa-user-plus"></i> Daftar Gratis
                </a>
                <a href="/auth/login" class="btn-hero secondary">
                    <i class="fas fa-sign-in-alt"></i> Masuk
                </a>
            </div>
        </div>
        <div class="hero-visual">
            <div class="carousel-container" id="heroCarousel">
                <div class="carousel-slide active">
                    <img src="https://images.unsplash.com/photo-1474487548417-781cb71495f3?w=800&q=80" alt="Kereta Api Modern">
                </div>
                <div class="carousel-slide">
                    <img src="https://images.unsplash.com/photo-1532105956626-9569c03602f6?w=800&q=80" alt="Stasiun Kereta">
                </div>
                <div class="carousel-slide">
                    <img src="https://images.unsplash.com/photo-1544620347-c4fd4a3d5957?w=800&q=80" alt="Perjalanan Kereta">
                </div>
                <div class="carousel-slide">
                    <img src="https://images.unsplash.com/photo-1515165562839-978bbcf18277?w=800&q=80" alt="Interior Kereta">
                </div>
                <div class="carousel-dots">
                    <button class="carousel-dot active" onclick="goToSlide(0)"></button>
                    <button class="carousel-dot" onclick="goToSlide(1)"></button>
                    <button class="carousel-dot" onclick="goToSlide(2)"></button>
                    <button class="carousel-dot" onclick="goToSlide(3)"></button>
                </div>
            </div>
        </div>
    </section>

    <!-- Clients/Partners -->
    <section class="clients-section">
        <p>Dipercaya oleh operator kereta api terkemuka</p>
        <div class="clients-grid">
            <div class="client-logo"><i class="fas fa-train"></i> KAI</div>
            <div class="client-logo"><i class="fas fa-subway"></i> LRT Jabodebek</div>
            <div class="client-logo"><i class="fas fa-tram"></i> MRT Jakarta</div>
            <div class="client-logo"><i class="fas fa-bus"></i> TransJakarta</div>
            <div class="client-logo"><i class="fas fa-route"></i> Railink</div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features-section">
        <h2 class="section-title">Kenapa SobatKereta?</h2>
        <p class="section-subtitle">Platform pemesanan tiket kereta yang dirancang untuk kemudahan dan kecepatan Anda</p>
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon blue"><i class="fas fa-search"></i></div>
                <h3>Pencarian Mudah</h3>
                <p>Temukan jadwal kereta dengan cepat berdasarkan rute, tanggal, dan kelas. Filter canggih membantu Anda menemukan perjalanan yang tepat.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon green"><i class="fas fa-shield-alt"></i></div>
                <h3>Pemesanan Aman</h3>
                <p>Transaksi terenkripsi dan aman. Sistem wallet terintegrasi memungkinkan pembayaran instan tanpa ribet.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon violet"><i class="fas fa-clock"></i></div>
                <h3>Pembaruan Real-time</h3>
                <p>Informasi jadwal dan ketersediaan kursi yang selalu terkini. Dapatkan notifikasi perubahan jadwal secara langsung.</p>
            </div>
        </div>
    </section>

    <!-- Stats Section -->
    <section class="stats-section">
        <h2 class="section-title">Angka Bicara</h2>
        <p class="section-subtitle">SobatKereta dalam angka yang membuktikan kualitas layanan</p>
        <div class="stats-grid">
            <div class="stat-item">
                <h3>10K+</h3>
                <p>Pengguna Aktif</p>
            </div>
            <div class="stat-item">
                <h3>50+</h3>
                <p>Rute Kereta</p>
            </div>
            <div class="stat-item">
                <h3>99.9%</h3>
                <p>Uptime Sistem</p>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta-section">
        <div class="cta-card">
            <h2>Siap Memesan Tiket?</h2>
            <p>Daftar gratis dan mulai pesan tiket kereta api dari mana saja, kapan saja. Tanpa biaya tambahan!</p>
            <a href="/auth/register" class="btn-hero primary">
                <i class="fas fa-rocket"></i> Mulai Sekarang
            </a>
        </div>
    </section>

    <!-- Footer -->
    <footer class="landing-footer">
        <p>&copy; 2025 SobatKereta. All rights reserved.</p>
        <div class="landing-footer-links">
            <a href="#">Tentang Kami</a>
            <a href="#">Kebijakan Privasi</a>
            <a href="#">Syarat & Ketentuan</a>
            <a href="#">Bantuan</a>
        </div>
    </footer>
</div>

<script>
    (function() {
        var currentSlide = 0;
        var slides = document.querySelectorAll('.carousel-slide');
        var dots = document.querySelectorAll('.carousel-dot');
        var totalSlides = slides.length;
        if (totalSlides === 0) return;

        function showSlide(index) {
            slides.forEach(function(s) { s.classList.remove('active'); });
            dots.forEach(function(d) { d.classList.remove('active'); });
            slides[index].classList.add('active');
            dots[index].classList.add('active');
            currentSlide = index;
        }

        window.goToSlide = function(index) {
            showSlide(index);
        };

        setInterval(function() {
            showSlide((currentSlide + 1) % totalSlides);
        }, 4000);
    })();
</script>
{{/if}}
